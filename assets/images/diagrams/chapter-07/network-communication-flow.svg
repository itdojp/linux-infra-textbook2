<?xml version="1.0" encoding="UTF-8"?>
<svg width="800" height="600" viewBox="0 0 800 600" xmlns="http://www.w3.org/2000/svg">
  <title>ネットワーク通信フロー</title>
  <desc>クライアントからサーバーまでのネットワーク通信経路</desc>
  
  <defs>
    <style>
      .title { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif; font-size: 16px; font-weight: 600; fill: #1a1a1a; }
      .section-title { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif; font-size: 14px; font-weight: 600; fill: #333; }
      .layer-name { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif; font-size: 11px; font-weight: 600; fill: #333; }
      .description { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif; font-size: 9px; font-weight: 400; fill: #666; }
      
      .client-box { fill: #e8f5e8; stroke: #388e3c; stroke-width: 2; rx: 8; }
      .network-box { fill: #fff3e0; stroke: #f57c00; stroke-width: 2; rx: 8; }
      .server-box { fill: #e3f2fd; stroke: #1976d2; stroke-width: 2; rx: 8; }
      .layer-box { fill: #ffffff; stroke: #666; stroke-width: 1; rx: 4; }
      .network-device { fill: #f5f5f5; stroke: #999; stroke-width: 1; rx: 4; }
      
      .flow-arrow { stroke: #f57c00; stroke-width: 3; fill: none; marker-end: url(#flow-arrowhead); }
      .connection-line { stroke: #666; stroke-width: 1; fill: none; }
    </style>
    
    <marker id="flow-arrowhead" markerWidth="12" markerHeight="9" refX="11" refY="4.5" orient="auto">
      <polygon points="0 0, 12 4.5, 0 9" fill="#f57c00" />
    </marker>
  </defs>
  
  <!-- Background -->
  <rect width="800" height="600" fill="#ffffff"/>
  
  <!-- Title -->
  <text x="400" y="25" text-anchor="middle" class="title">ネットワーク通信フロー</text>
  
  <!-- Client Side -->
  <rect x="50" y="60" width="200" height="280" class="client-box"/>
  <text x="150" y="85" text-anchor="middle" class="section-title">クライアント側</text>
  
  <!-- Client layers -->
  <rect x="70" y="100" width="160" height="40" class="layer-box"/>
  <text x="150" y="115" text-anchor="middle" class="layer-name">アプリケーション</text>
  <text x="150" y="130" text-anchor="middle" class="description">curl, browser</text>
  
  <rect x="70" y="150" width="160" height="40" class="layer-box"/>
  <text x="150" y="165" text-anchor="middle" class="layer-name">TCP/UDP層</text>
  <text x="150" y="180" text-anchor="middle" class="description">ポート管理</text>
  
  <rect x="70" y="200" width="160" height="40" class="layer-box"/>
  <text x="150" y="215" text-anchor="middle" class="layer-name">IP層</text>
  <text x="150" y="230" text-anchor="middle" class="description">ルーティング</text>
  
  <rect x="70" y="250" width="160" height="40" class="layer-box"/>
  <text x="150" y="265" text-anchor="middle" class="layer-name">リンク層</text>
  <text x="150" y="280" text-anchor="middle" class="description">Ethernet</text>
  
  <rect x="70" y="300" width="160" height="30" class="layer-box"/>
  <text x="150" y="315" text-anchor="middle" class="layer-name">物理層</text>
  <text x="150" y="325" text-anchor="middle" class="description">NIC</text>
  
  <!-- Network Infrastructure -->
  <rect x="300" y="60" width="200" height="280" class="network-box"/>
  <text x="400" y="85" text-anchor="middle" class="section-title">ネットワーク</text>
  
  <!-- Network devices -->
  <rect x="320" y="110" width="160" height="35" class="network-device"/>
  <text x="400" y="125" text-anchor="middle" class="layer-name">ローカルスイッチ</text>
  <text x="400" y="138" text-anchor="middle" class="description">L2スイッチング</text>
  
  <rect x="320" y="160" width="160" height="35" class="network-device"/>
  <text x="400" y="175" text-anchor="middle" class="layer-name">ルーター/ゲートウェイ</text>
  <text x="400" y="188" text-anchor="middle" class="description">L3ルーティング</text>
  
  <rect x="320" y="210" width="160" height="35" class="network-device"/>
  <text x="400" y="225" text-anchor="middle" class="layer-name">ISP</text>
  <text x="400" y="238" text-anchor="middle" class="description">インターネット接続</text>
  
  <rect x="320" y="260" width="160" height="35" class="network-device"/>
  <text x="400" y="275" text-anchor="middle" class="layer-name">インターネット</text>
  <text x="400" y="288" text-anchor="middle" class="description">グローバルネットワーク</text>
  
  <!-- Server Side -->
  <rect x="550" y="60" width="200" height="280" class="server-box"/>
  <text x="650" y="85" text-anchor="middle" class="section-title">サーバー側</text>
  
  <!-- Server layers (mirror of client) -->
  <rect x="570" y="100" width="160" height="40" class="layer-box"/>
  <text x="650" y="115" text-anchor="middle" class="layer-name">アプリケーション</text>
  <text x="650" y="130" text-anchor="middle" class="description">nginx, apache</text>
  
  <rect x="570" y="150" width="160" height="40" class="layer-box"/>
  <text x="650" y="165" text-anchor="middle" class="layer-name">TCP/UDP層</text>
  <text x="650" y="180" text-anchor="middle" class="description">ポート管理</text>
  
  <rect x="570" y="200" width="160" height="40" class="layer-box"/>
  <text x="650" y="215" text-anchor="middle" class="layer-name">IP層</text>
  <text x="650" y="230" text-anchor="middle" class="description">ルーティング</text>
  
  <rect x="570" y="250" width="160" height="40" class="layer-box"/>
  <text x="650" y="265" text-anchor="middle" class="layer-name">リンク層</text>
  <text x="650" y="280" text-anchor="middle" class="description">Ethernet</text>
  
  <rect x="570" y="300" width="160" height="30" class="layer-box"/>
  <text x="650" y="315" text-anchor="middle" class="layer-name">物理層</text>
  <text x="650" y="325" text-anchor="middle" class="description">NIC</text>
  
  <!-- Flow arrows -->
  <path d="M 250 200 Q 350 180 320 127" class="flow-arrow"/>
  <line x1="480" y1="127" x2="550" y2="200" class="flow-arrow"/>
  
  <text x="350" y="170" text-anchor="middle" class="description" fill="#f57c00">📡 データパケット</text>
  <text x="350" y="185" text-anchor="middle" class="description" fill="#f57c00">送信経路</text>
  
  <!-- Connection lines between layers -->
  <line x1="150" y1="140" x2="150" y2="150" class="connection-line"/>
  <line x1="150" y1="190" x2="150" y2="200" class="connection-line"/>
  <line x1="150" y1="240" x2="150" y2="250" class="connection-line"/>
  <line x1="150" y1="290" x2="150" y2="300" class="connection-line"/>
  
  <line x1="650" y1="140" x2="650" y2="150" class="connection-line"/>
  <line x1="650" y1="190" x2="650" y2="200" class="connection-line"/>
  <line x1="650" y1="240" x2="650" y2="250" class="connection-line"/>
  <line x1="650" y1="290" x2="650" y2="300" class="connection-line"/>
  
  <!-- Protocol information -->
  <rect x="50" y="370" width="700" height="180" fill="#f8f9fa" stroke="#dee2e6" stroke-width="1" rx="4"/>
  <text x="70" y="395" class="section-title">🌐 通信プロトコルとヘッダー情報</text>
  
  <!-- Protocol details -->
  <text x="70" y="420" class="layer-name">📱 アプリケーション層</text>
  <text x="70" y="435" class="description">• HTTP/HTTPS リクエスト • JSON/XMLデータ • RESTful API</text>
  
  <text x="270" y="420" class="layer-name">🚚 トランスポート層</text>
  <text x="270" y="435" class="description">• TCPヘッダー（ポート番号） • UDPヘッダー（軽量通信） • 信頼性制御</text>
  
  <text x="470" y="420" class="layer-name">🗺️ ネットワーク層</text>
  <text x="470" y="435" class="description">• IPヘッダー（送信元・宛先IP） • ルーティング情報 • TTL制御</text>
  
  <text x="70" y="465" class="layer-name">🔗 データリンク層</text>
  <text x="70" y="480" class="description">• Ethernetヘッダー（MACアドレス） • フレーム同期 • エラー検出</text>
  
  <text x="350" y="465" class="layer-name">⚡ 物理層</text>
  <text x="350" y="480" class="description">• 電気信号/光信号 • ケーブル/無線 • 信号同期</text>
  
  <!-- Path description -->
  <text x="70" y="510" class="section-title">📋 通信経路の詳細</text>
  <text x="70" y="530" class="description">1. クライアントアプリケーションがHTTPリクエストを生成</text>
  <text x="70" y="545" class="description">2. TCPポート80/443でサーバーとの接続を確立</text>
  <text x="70" y="560" class="description">3. IPアドレスを基にルーティングテーブルを参照してパケット転送</text>
  <text x="70" y="575" class="description">4. MACアドレスでローカルネットワーク内の次ホップを特定</text>
  <text x="70" y="590" class="description">5. 物理層で電気/光信号としてネットワークケーブル経由で送信</text>
</svg>